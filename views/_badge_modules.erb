<% settings = @badge_placement_config.merged_settings || {} %>
<% if @modules_json && @modules_json.length > 0 %>
  <div class="control-group advanced">
    <label class="control-label"><%= I18n.t("partials.badge_modules.completion_required") %></label>
    <div class="controls">
      <% @modules_json.each do |mod| %>
        <% mod_settings = (settings['modules'] || []).detect{|m| m[0] == mod['id'] } %>
        <% checked = !!mod_settings %>
        <div class='module'>
          <label style='display: inline-block'>
            <input type="checkbox" <%= 'checked' if checked %> name="module_<%= mod['id'] %>" value="<%= CGI.escape(mod['name']) %>"/>
            <%= mod['name'] %>
          </label>
          <input type="text" name="credits_for_mod_<%= mod['id'] %>" class="credits span1" title="Credits for <%= mod['name'] %>" placeholder="credits" value="<%= (mod_settings && mod_settings[2]) || "" %>"/>
        </div>
      <% end %>
    </div>
  </div>
<%  end %>
